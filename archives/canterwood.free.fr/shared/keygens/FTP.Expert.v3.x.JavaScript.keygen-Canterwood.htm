<script language="JavaScript">

/******************************************************************************
 *                                                                            *
 *      ████▀▀█  █▀▀▀▀▀█▀▀█▀▄     █▀▀▀███                                     *
 *      █▓░   █  █     █  █ ░▀▄   █    ▓█                                     *
 *      █▓    █  █     █  █   ░█  █    ▒█                                     *
 *      █░    █  █     █  █  ░▒█  █    ░█                                     *
 *      █     █  █░    █  █ ░▒▓█  █     █    .    ▄▄           ▄    ▄▄        *
 *      █▒    █  █░    █  ▀▄▒▓▓█  █     █    ì▄ ██▀▀¦         ███  ████       *
 *      █▒    █  █░░   █    ▀███  █     █     ì██   █   ▄██¦ ▄█ ▀██▀  ██      *
 *      █▓░   █  █▒░   █      ▀█  █    ░█ ì▀   █ ▀██▀ -▀   █¦█    █    █      *
 *      █▓▒   █  █▒░   █          █     ■ █  ▄-█            █ì▄   ¦    █      *
 *      █▓▒░  █  █▓▒░  █          █    ▄████▀  ▀█   ▄ ì██▄  █ █        ì      *
 *      █▓▓░░ █  █▓▒░  █      ▄█  █  -▀▀■ █      ▀▄▄¦ █   ▀.█  ▀¦       ▀     *
 *      █▓▓▒▒░█  █▓▓▒░ █    ▄▀░█  █   ░▒█ ì  █▀       ▀▀▄▄▄▄¦   █             *
 *      █▓▓▒▓▓█  ██▓▒░ █  ▄▀  ░█  █   ▒▓█  ▀█▀                -▀  ▄▄▄▄        *
 *     ▄█▓▓▓▓▓█▀▄██▓▓░ █  █  ░▒█  █  ░▒▓█    ┌              ┐  ▄███████▄      *
 *   ▄▀ █▓▓▓███ ▀███▓▒░█  █ ░▒▓█  █  ▒▓██    │AlwAYs LoOking│▄▀      ▀██¦     *
 *  ██  █▓████▀  ▀███▓▒█  █ ▒▓█▀  ▀▄▓▓███    │   fORwArd!   │█        ██      *
 * ██   ████▀      ▀████  █░█▀      ▀████    └              ┘ ▀.      █▀      *
 * ███  ██▀          ▀▄█▄▄█▀          ▀██                           ▄▀        *
 *  ███ ▀               ▀▀▄▄▄▄          ▀                       ▄▄▄▀▀         *
 *   ▀▄▀■                    ▀▀▀▀▀▀▄▄▄▄▄▄▄▄▄                 ▄▄▄▀▀            *
 *     ■:.                                ▀▀▀▀▀▄▄▄▄▄▄▄▄▄▄▄▀▀▀▀                *
 *                                                                            *
 ******************************************************************************/

/* FTP Expert 3.x keygen
 * =============================================================================
 * Author     : Canterwood <canterwood@altern.org>
 * Description: this script provides a function that simulates the FTP Expert
 *              serial generation...
 *              Tested under Internet Explorer 6 and Mozilla 1.3.
 * Version    : 1.0.0.1 [07.05.2004]
 * Greetings  : The Analyst, Lise_Grim, RocketSpawn, +Christal...
 * =============================================================================
 * Copyright © 2003-2004 ICI */

/* generateKey function
 * -----------------------------------------------------------------------------
 * Use         : string generateKey(string name)
 * Return value: a serial, or a null string (""), if the name is invalid
 * IMPORTANT   : the name cannot be null, and it must be under 41 characters
 * -----------------------------------------------------------------------------
 */
function generateKey(name) {
  serial = "";

  table = "THTVEKYZ39852352GDDFHBCXXPFG347";
  modifiedTable = "";

// Name checking
// -----------------------------------------------------------------------------
  firstchar = 0, lastchar = 0;

  for(i = 0; i < name.length; i++)
    if(name.charAt(i) != ' ') {
      firstchar = name.indexOf(name.charAt(i));
      break;
    }

  for(i = name.length - 1; i > 0; i--)
    if(name.charAt(i) != ' ') {
      lastchar = name.lastIndexOf(name.charAt(i)) + 1;
      break;
    }

  name = name.substring(firstchar, lastchar).toUpperCase();
// -----------------------------------------------------------------------------

  if(name.length != 0) {

// Modified table generation
// -----------------------------------------------------------------------------
    for(i = 0; i < name.length; i++)
      if(table.indexOf(name.charAt(i)) != -1)
        modifiedTable += name.charAt(i);

    modifiedTableLength = modifiedTable.length;

    if(modifiedTableLength < 24)
      for(i = 0; i < 24 - modifiedTableLength; i++)
        modifiedTable += table.charAt(i);
// -----------------------------------------------------------------------------

// Serial generation
// -----------------------------------------------------------------------------
    remainder = 0;

    for(i = 1; i < 25; i++) {
      charPos = table.indexOf(modifiedTable.charAt(i - 1)) + 1;

      remainder = ((charPos * charPos - charPos) + remainder) % 31 + 1;

      serial += table.charAt(remainder - 1);

      if(i % 6 == 0 && i != 24)
        serial += '-';
    }
// -----------------------------------------------------------------------------

  }

  return serial;
}

// Example of implementation
// -----------------------------------------------------------------------------
document.write("<html><head><title>FTP Expert 3.x keygen by Canterwood</title></head><body><pre>");

name = prompt("Name:", "Canterwood");

if(name != null && name != "null") {

  if(name.length < 41) {
    serial = generateKey(name);

    if(serial != "") {
      document.write("Name  : " + name + "\n");
      document.write("Serial: " + serial);
    }
    else
      alert("You must enter a valid name.");
  }

  else
    alert("Your name must be under 41 characters.");
}
else
  alert("Your must enter a name.");

document.write("</pre></body></html>");
// -----------------------------------------------------------------------------

</script>