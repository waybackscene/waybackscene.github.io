<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>

<HEAD>
	<META HTTP-EQUIV="Content-Type" CONTENT="text/html;CHARSET=iso-8859-1">
<!--  formamus.htm version 02 February 1998 
      INSTRUCTIONS FOR SUBMITTING: DO NOT USE HTML EDITORS!
      SEARCH THIS TEXT FOR THE STRING "Your_" 
      AND REPLACE WITH WHATEVER YOU WANT TO PUBLISH! 
      THANKS A LOT: this will allow automated retrieval -->

	<META NAME="GENERATOR" Content="Notepad">
	<TITLE>WiA Document</TITLE>

	<STYLE TYPE="text/css">
	<!--
	P.MsoNormal	 {
			MARGIN : 0cm 0cm 0pt     ;
			mso-style-parent : ""; mso-pagination: widow-orphan     ;
			mso-fareast-font-family : "Times New Roman"     ;
			Font-Family : Times New Roman ;
			Font-Size : 10pt
		}
	H1	 {
			MARGIN : 0cm 0cm 0pt     ;
			mso-pagination : widow-orphan     ;
			mso-style-next : Normal     ;
			mso-outline-level : 1     ;
			mso-font-kerning : 0pt     ;
			Font-Family : Arial Black ;
			Font-Size : 14pt
		}
	H2	 {
			MARGIN : 0cm 0cm 0pt     ;
			mso-pagination : widow-orphan     ;
			mso-style-next : Normal     ;
			mso-outline-level : 2     ;
			Font-Family : Arial ;
			Font-Size : 12pt
		}
	H3	 {
			MARGIN : 0cm 0cm 0pt 18pt     ;
			FONT-VARIANT : small-caps     ;
			mso-pagination : widow-orphan     ;
			mso-style-next : Normal     ;
			mso-outline-level : 3     ;
			Text-Align : Center ;
			Font-Family : Arial ;
			Font-Size : 12pt
		}
	H4	 {
			MARGIN : 0cm 0cm 0pt 18pt     ;
			mso-pagination : widow-orphan     ;
			mso-style-next : Normal     ;
			mso-outline-level : 4     ;
			text-underline : single     ;
			Font-Family : Arial ;
			Font-Size : 12pt ;
			Text-Decoration : Underline
		}
	H5	 {
			MARGIN : 0cm 0cm 0pt 18pt     ;
			mso-pagination : widow-orphan     ;
			mso-style-next : Normal     ;
			mso-outline-level : 5     ;
			Font-Family : Arial ;
			Font-Size : 10pt
		}
	DIV.Section1	 {
			page : Section1
		}
	-->
	</STYLE>

</HEAD>

<BODY BACKGROUND="images/fondopri.jpeg" TEXT="black" BGCOLOR="#000099" LINK="red" VLINK="#99CCFF">


<BLOCKQUOTE>
	<P ALIGN="RIGHT"><B><FONT SIZE="5" COLOR="#FFCC00" FACE="Arial Black">Protection Maison : Christal 5.0</FONT></B></P>
	<P><FONT SIZE="2" COLOR="white" FACE="Arial">By WiA Team</FONT></P>
</BLOCKQUOTE>

<CENTER>
<P>
<TABLE BORDER="0" CELLPADDING="8" CELLSPACING="0" WIDTH="91%">
<TBODY>
  					<TR>
		<TD WIDTH="100%" BGCOLOR="#FFFF99">
			<DIV CLASS="Section1">
				<P><SPAN STYLE="Font-Size : 10pt"><FONT FACE="Arial">Aujourd'hui, on va faire l'&eacute;tude d'une petite &quot;protection
				maison&quot; : Christal 5.0 ( </FONT></SPAN><A HREF="http://christal1.cjb.net" target="_blank"><SPAN STYLE="Font-Size : 10pt"><FONT
				FACE="Arial">http://christal1.cjb.net</FONT></SPAN></A><SPAN STYLE="Font-Size : 10pt"><FONT FACE="Arial"> )<BR>
				Un d&eacute;sassembleur ( IDA, W32Dasm,... ) et un &eacute;diteur hexad&eacute;cimal ( Hiew, Hexworkshop, etc )
				ou un String Viewer ( Showstring ) suffiront largement &agrave; l'&eacute;tude.<BR>
				Disponibilit&eacute; : selon timing.<BR>
				<BR>
				Christal a &eacute;t&eacute; d&eacute;velopp&eacute;, tr&egrave;s certainement, en 1997 dans l'anonymat le plus
				total pour atteindre aujourd'hui la r&eacute;putation qu'on lui connait.<BR>
				Les premi&egrave;res versions de Christal sont apparues sporadiquement chez LittleBobJr et ont &eacute;t&eacute;
				test&eacute;es avec succ&egrave;s dans 4 cas bien d&eacute;finis :<BR>
				- La Main Rouge<BR>
				- ATP Team<BR>
				- Le Groupe de Travail<BR>
				- La Christal Page<BR>
				<BR>
				Certaines releases ont tr&egrave;s certainement &eacute;chapp&eacute; &agrave; l'&eacute;tude mais cela reste &agrave;
				confirmer.<BR>
				<BR>
				La version actuelle, Christal 5.0, s'av&eacute;re dot&eacute;e d'un moteur de t&acirc;che polymorphique avanc&eacute;,
				lui permettant d'&eacute;voluer avec aisance dans la Cryptographie et le d&eacute;veloppement / programmation en
				ASM.<BR>
				En outre, son aptitude a utilis&eacute; le &quot;Recursive Tunneling&quot; force Christal 5.0 &agrave; se lancer
				dans toutes &eacute;tudes pouss&eacute;es quelqu'elles soient, voir challenges type Reverse Engeenering Academy
				( REA ).<BR>
				Toutefois, pour ce dernier cas, un bug a &eacute;t&eacute; d&eacute;tect&eacute; par l'encryptage de la Signature
				&quot;c.h.r.i.s.t.a.l&quot; en &quot;l.a.t.s.i.r.h.c&quot;.<BR>
				Ce bug avait d&eacute;j&agrave; &eacute;t&eacute; constat&eacute; auparavant.<BR>
				<BR>
				Christal 5.0 est fourni avec une librairie cons&eacute;quente, dispos&eacute;e sur 3 sites , permettant de palier
				&agrave; toute situation critique par l'utilisateur :<BR>
				- http://foundme.cjb.net<BR>
				- http://afrt.cjb.net<BR>
				- http://christal1.cjb.net<BR>
				<BR>
				Christal 5.0 s'av&eacute;re peu gourmand en ressources syst&egrave;me. Quelques crackmes suffisent largement &agrave;
				le maintenir en activit&eacute; et op&eacute;rationnel.</FONT></SPAN>
			</DIV>
			<P><STRONG><U><FONT SIZE="2" FACE="Arial">I \ L'Analyse<BR>
			<BR>
			</FONT></U></STRONG><FONT SIZE="2" FACE="Arial">Avec Showstring, on constate que Christal 5.0 s'av&egrave;re riche
			en renseignements :</FONT></P>
			<CENTER>
			<P>
			<TABLE BORDER="0" WIDTH="80%" BGCOLOR="white">
				<TR>
					<TD WIDTH="100%">
						<PRE><B><SPAN STYLE="Font-Size : 10pt"><FONT FACE="Arial">0000004D  !This program cannot be run in Groupe mode.
00000178  .text
000001A1  .rdata
000001C9  .data
000001F1  .idata
00000219  .rsrc
00000241  .reloc
00000272  .tutors </FONT></SPAN><SPAN STYLE="Font-Size : 10pt"><FONT COLOR="red" FACE="Arial">&lt;-- ?</FONT></SPAN><SPAN
						STYLE="Font-Size : 10pt"><FONT FACE="Arial">
0000080F  .outils</FONT></SPAN><SPAN STYLE="Font-Size : 10pt"><FONT COLOR="red" FACE="Arial"> &lt;-- ?</FONT></SPAN></B></PRE>
					</TD>
				</TR>
			</TABLE>

</CENTER>
			<DIV CLASS="Section1">
				<P><FONT SIZE="2" FACE="Arial">La pr&eacute;sence de sections suppl&eacute;mentaires d&eacute;notent certainement
				un code suppl&eacute;mentaire aux programmes standards.</FONT>
			</DIV>
			<DIV ALIGN="CENTER" CLASS="Section1">
				<P>
				<TABLE BORDER="0" WIDTH="80%" BGCOLOR="white">
					<TR>
						<TD WIDTH="100%">
							<PRE><B><SPAN STYLE="Font-Size : 10pt"><FONT FACE="Arial">00006D1C  Standard Analysing 
00006D46  Debugging
00006D70  Unpacking
00006D9A  Anti-debugging  
00006DC4  DeProtectoring
00006DEE  VBOXing
00006E20  Cryptography Analysing
00006E4A  Keygenning
00006E86  VBA blasting
00006E9C  Reversing
00006EBE  ASM Programming
00006EDC Tutoring 
00006EF2  Guru-ing 
00006F16  Putting my WebSites en Bordeling 
00006F3C  Sorting connering contring Female Cracking
00006FFF Taking rouleau de patissering on the head</FONT></SPAN></B></PRE>
						</TD>
					</TR>
				</TABLE>

			</DIV>
			<DIV CLASS="Section1">
				<P><FONT SIZE="2" FACE="Arial">Ok, Christal 4.0 n'est pas &agrave; classer dans le basique.<BR>
				<BR>
				Le passage sous IDA s'av&eacute;re &eacute;tonnant !</FONT>
			</DIV>
			<DIV ALIGN="CENTER" CLASS="Section1">
				<P><IMG SRC="images/tool01.gif" WIDTH="542" HEIGHT="90" ALIGN="BOTTOM" BORDER="0">
			</DIV>
			<DIV CLASS="Section1">
				<P><FONT SIZE="2" FACE="Arial">Le sch&eacute;ma de d&eacute;tournement d'activit&eacute; est tout bonnement stup&eacute;fiant
				!<BR>
				</FONT><B><FONT SIZE="2" COLOR="olive" FACE="Arial">- Techniques d'anti-debugging avanc&eacute;es par saturation
				phonique stridente et prolong&eacute;e. ( en verdatre )</FONT></B><FONT SIZE="2" FACE="Arial"><BR>
				</FONT><B><FONT SIZE="2" COLOR="#FF00CC" FACE="Arial">- Fake jumps ( puis real ) et zigzagment progressif du tra&ccedil;age
				par accumulation alcoolique. ( en rose )<BR>
				</FONT><FONT SIZE="2" COLOR="#999999" FACE="Arial">- Boites de dialogue d'avertissement accompagn&eacute;es de
				rugissements incoh&eacute;rents pour bloquer le debugger et apeurer le cracker. ( en gris )</FONT><FONT SIZE="2"
				COLOR="silver" FACE="Arial"><BR>
				<BR>
				</FONT></B><FONT SIZE="2" FACE="Arial">Christal 5.0 dispose de 3 entry-points compartiment&eacute;s et bien s&eacute;par&eacute;s
				dans les sections les plus importantes ! ( </FONT><B><FONT SIZE="2" COLOR="#0099FF" FACE="Arial">en bleu clair</FONT></B><FONT
				SIZE="2" FACE="Arial">, </FONT><B><FONT SIZE="2" COLOR="#003399" FACE="Arial">bleu marine</FONT></B><FONT SIZE="2"
				FACE="Arial"> et </FONT><B><FONT SIZE="2" COLOR="#660033" FACE="Arial">marron</FONT></B><FONT SIZE="2" FACE="Arial">
				)<BR>
				<BR>
				La suite de l'&eacute;tude via IDA, nous am&eacute;ne &agrave; tomber dans les sections suppl&eacute;mentaires
				constat&eacute;es avec Showstring.</FONT>
			</DIV>
			<DIV ALIGN="CENTER" CLASS="Section1">
				<P>
				<TABLE BORDER="0" WIDTH="80%" BGCOLOR="white">
					<TR>
						<TD WIDTH="100%">
							<PRE>.tutors:004020EB                 cmp     ANNEE, 1999
.tutors:004020F1                 je      short groupe_travail
.tutors:004020F6                 push    eax             ; Christal's Page
.tutors:004020F7                 push    hDlg            ; HTML
.tutors:004020FD                 call    ds:WriteFile
.tutors:00402103                 call    ds:WebSite
.tutors:00402105                 jmp     updater_news 
.tutors:00402107 
.tutors:00402107 groupe_travail:        
.tutors:00402107                 push    TJ_Phone        ; not defined 
.tutors:00402109                 call    ds:TEEJI
.tutors:0040211C                 push    PULSAR_ICQ      ; not defined
.tutors:0040211F                 call    ds:PULSAR
.tutors:004022A3                 push    EL_CARACOL_Phone ; not defined
.tutors:004022A5                 call    ds:EL_CARACOL</PRE>
						</TD>
					</TR>
				</TABLE>

			</DIV>
			<DIV CLASS="Section1">
				<P><FONT SIZE="2" FACE="Arial">Ainsi nous retrouvons trace du d&eacute;veloppement pr&eacute;c&eacute;dent sur
				les versions 1.0 et 2.0 de Christal, aussi appel&eacute;es versions &quot;Groupe de travail&quot;.<BR>
				La suite du d&eacute;sassemblage permet de mieux analyser la routine d'updatage de ses librairies.</FONT>
			</DIV>
			<DIV ALIGN="CENTER" CLASS="Section1">
				<P><FONT SIZE="2" FACE="Arial"><BR>
				
				<TABLE BORDER="0" WIDTH="80%" BGCOLOR="white">
					<TR>
						<TD WIDTH="100%">
							<PRE>.tutors:00402407 updater_news:
.tutors:00402407                 mov     eax, bordel_complet   
.tutors:0040240A                 cmp     organisation_site, eax
.tutors:00402411                 jl      creation_nouveau_site
.tutors:0040241C                 mov     eax, is_good_photo_in_playboy  ; boolean    
.tutors:0040241F                 test    eax, eax
.tutors:004024A3                 je      raw_update
.tutors:004024A5                 push    path_hidden_link
.tutors:004024A8                 call    UpdateMyPhotoPinup
.tutors:004024AA raw_update:
.tutors:004024AA                 push    name_file
.tutors:004024B0                 call    WriteNewsFile
.tutors:004024B8                 jmp     organisation_my_website                       </PRE>
						</TD>
					</TR>
				</TABLE>
</FONT>
			</DIV>
			<DIV CLASS="Section1">
				<P><FONT SIZE="2" FACE="Arial">Christal 5.0 ( depuis la 3.0 s&ucirc;rement ) dispose d'un syst&egrave;me de mise
				&agrave; jour photographique &quot;P.I.N.U.P&quot; visant &agrave; d&eacute;router le Cracker, qui essaierait de
				modifier sa page.<BR>
				NB : La version 4.1 </FONT><B><FONT SIZE="2" FACE="Arial">BETA</FONT></B><FONT SIZE="2" FACE="Arial"> dispose d'une
				fonction d'exportation de la mise &agrave; jour photographique au travers de la routine &quot;release_my_cryptotool1.0_with_disabled_button&quot;.<BR>
				<BR>
				La suite de l'&eacute;tude de la section &quot;Tutors&quot; a du &ecirc;tre abandonn&eacute; sur la routine &quot;organisation_my_website&quot;,
				le WiA ne disposant pas d'assez d'&eacute;l&eacute;ments dans les ph&eacute;nom&egrave;nes li&eacute;s &agrave;
				&quot;la Th&eacute;orie du Chaos&quot;, bien connu dans la Physique moderne ( WinGraph d'IDA en t&eacute;moigne
				) et de puissance de calcul pour poursuivre l'investigation.</FONT>
			</DIV>
			<DIV ALIGN="CENTER" CLASS="Section1">
				<P><IMG SRC="images/call_flow.gif" WIDTH="465" HEIGHT="424" ALIGN="BOTTOM" BORDER="0">
			</DIV>
			<DIV CLASS="Section1">
				<P><FONT SIZE="2" FACE="Arial">M&ecirc;me le passage sous Softice s'av&eacute;ra infructeux...</FONT>
			</DIV>
			<DIV ALIGN="CENTER" CLASS="Section1">
				<P><IMG SRC="images/si.gif" WIDTH="518" HEIGHT="417" ALIGN="BOTTOM" BORDER="0">
			</DIV>
			<DIV CLASS="Section1">
				<P><FONT SIZE="2" FACE="Arial"><BR>
				Le passage sur le code de la section Outils s'av&eacute;re aussi instructif.</FONT>
			</DIV>
			<DIV ALIGN="CENTER" CLASS="Section1">
				<P>
				<TABLE BORDER="0" WIDTH="80%" BGCOLOR="white">
					<TR>
						<TD WIDTH="100%">
							<PRE>.outils:0040311A                 push    Roy         
.outils:0040311F                 push    Vom_Bonjour  
.outils:00403120                 push    Iczelion    
.outils:00403121                 call    ds:IRC
.outils:0040312F                 test    eax, eax
.outils:00403132                 jnz     programmation_ok
.outils:00403135                 push    W32ASM_MSGB
.outils:0040313F                 call    ds:Forum
.outils:00403145                 test    eax, eax
.outils:00403149                 jnz     programmation_ok
.outils:00403153                 push    CC_REF  ; &quot;Passer de l'ASM au C en 20 le&ccedil;ons&quot;
.outils:00403157                 call    ds:Reconversion</PRE>
						</TD>
					</TR>
				</TABLE>

			</DIV>
			<DIV CLASS="Section1">
				<P><SPAN STYLE="Font-Size : 10pt"><FONT FACE="Arial">La suite du d&eacute;sassemblage nous montre un gros Bug dans
				la suite de la routine.</FONT></SPAN>
			</DIV>
			<DIV ALIGN="CENTER" CLASS="Section1">
				<P>
				<TABLE BORDER="0" WIDTH="80%" BGCOLOR="white">
					<TR>
						<TD WIDTH="100%">
							<PRE>.outils:0040511F my_tool_finished:       
.outils:0040511F                 xor     eax, eax  
.outils:00405120                 test    eax, eax    
.outils:00405121                 jnz     ask_for_reference_on_protools <FONT COLOR="red">&lt;-- ICI !</FONT>
.outils:0040512F                 mov     dword ptr [protools], eax</PRE>
						</TD>
					</TR>
				</TABLE>

			</DIV>
			<DIV CLASS="Section1">
				<P><SPAN STYLE="Font-Size : 10pt"><FONT FACE="Arial">La valeur d'eax &eacute;tant toujours &agrave; z&eacute;ro,
				le saut ne sera jamais fait.</FONT></SPAN><BR>
				<SPAN STYLE="Font-Size : 10pt"><FONT FACE="Arial">La version de Christal 5.1 releas&eacute;e aujourd'hui ( 26/09/2002
				) ne contient plus ce bug depuis.<BR>
				</FONT></SPAN><FONT SIZE="2" FACE="Arial"><BR>
				WiA ( mode Sympa ON)<BR>
				<BR>
				NB: Naturellement cette &eacute;tude n'est pas viable &agrave; 100 %, et l'auteur de Christal 5.0 peut encore surprendre
				par ses id&eacute;es et ses d&eacute;veloppements.</FONT>
			</DIV>
		</TD>
	</TR>
</TBODY></TABLE>

</CENTER>

<BLOCKQUOTE>
	<P><FONT COLOR="white">Ce sera tout pour aujourd'hui, </FONT><FONT SIZE="2" COLOR="white" FACE="Arial">si vous
	n'avez pas tout compris ou si vous trouvez des erreurs, n'h&eacute;sitez pas &agrave; nous envoyer un </FONT><A
	HREF="mailto:womeninaction@voila.fr"><FONT SIZE="2" FACE="Arial">mail</FONT></A><FONT SIZE="2" COLOR="white" FACE="Arial">.</FONT>
</BLOCKQUOTE>


</BODY>

</HTML>